---
title: "The Impact of Rent Increases on Different Incomes in Amsterdam-West and Amsterdam-Zuid (2017 vs. 2019)"
author: "Sara Hamming-2862636, Kayra Civil-2822767, Aysenur Erkılıç-2839646, Ela Köycü-2846357, Daniëlle Goede-2853993, Jesper Kouw-2863970"
date: "`r Sys.Date()`"
output: pdf_document
---

# Set-up your environment

```{r packages, include=FALSE}

install.packages("sf")
require(tidyverse)
require(dplyr)
require(stringr)
require(readr)
require(sf)        
require(ggplot2)  
require(viridis)
```

# Title Page

Sara Hamming-2862636, Kayra Civil-2822767, Aysenur Erkılıç-2839646, Ela Köycü-286357, Daniëlle Goede-2853993, Jesper Kouw-2863970

Tutorial 2, Group 7

Chantal Schouwenaar

# Part 1 - Identify a Social Problem

## 1.1 Describe the Social Problem

***The Impact of Rent Increases on Different Incomes in Amsterdam West vs Amsterdam Zuid***

In the last few years, rent prices in the Netherlands have increased significantly, especially in cities like Amsterdam. Within Amsterdam, wijks such as Amsterdam West and Amsterdam Zuid have seen noticeable differences in how rising rents affect residents. This has made it increasingly difficult for people with low or average incomes to find affordable housing (Eichholtz, 2022).

While some people's incomes have not increased much, rents continue to rise. This means a larger portion of their income goes to rent, leaving less for essential needs like food, healthcare, or education (Custers, 2022).

Between 2017 and 2019, Amsterdam saw an increase of long-term rental homes being switched into short-term tourist lets on platforms like Airbnb, which reduced the supply of housing for residents and drove up rental prices. To oppose this the city first limited home‐sharing to 60 nights per year in 2018 and then halved that limit to 30 nights in 2019, and although these rules slowed the growth of short‐term lets, they came after rents had already spiked, so long‐term rents continued to climb despite the new regulations. (Valente, 2023)

This is a serious issue because everyone needs a safe and affordable place to live. If rent prices keep rising, some residents may be forced to move to less desirable areas, live in smaller or lower-quality homes, or even face homelessness. By examining rent prices from 2017 to 2019 and comparing the impact on different incomes in Amsterdam West and Amsterdam Zuid, we can gain a better understanding of who is most affected. This insight is crucial for creating more effective and fair housing policies in the future.

Most studies on Amsterdam’s rising only look at city-wide numbers and treat entire boroughs the same. This study focuses on the key 2017–2019 period when Airbnb really took off and new regulations were introduced, breaks the data down into small wijks in West and Zuid, and shows solid statistics to help shape fairer housing policies.

# Part 2 - Data Sourcing

## 2.1 Load in the data

```{r loading_data}
dataset <- read_csv("data/huurprijzen.csv")
dataset_2<- read_csv("data/kerncijfers_wijken_en_buurten_2015.csv")
dataset_3<- read_csv("data/kerncijfers_wijken_en_buurten_2017.csv")
dataset_4<- read_csv("data/kerncijfers_wijken_en_buurten_2019.csv")
```

## 2.2 Provide a short summary of the dataset(s)

```{r}
head(dataset)
```

The first data-set is an Excel sheet with the rent prices of every district of Amsterdam over the years 2013, 2015, 2017, 2019 both from particular and corporate. This is a credible source because the rent series comes directly from the City of Amsterdam’s official rental register.

```{r}
head(dataset_2)
```

The second dataset is a csv file with all the neighborhoods of Amsterdam with all types of different variables, such as the population per neighborhood, types of houses, incomes and incomes of different groups, etc. This is a credible source because it comes from CBS, a well trusted source also CBS data is seen as a gold‐standard source for understanding economic and social trends in the Netherlands.

## 2.3 Describe the type of variables included

***Income-related variables:***

· Average income per income receiver in x1000, we chose this variable because it was available over multiple years and shows how much an average household is able to spend.

These income data are not self-reported but derived from administrative sources. Statistics Netherlands (CBS) compiles income information using tax returns and government administrative records (e.g., benefits and allowances), calculating the disposable income per household. Each household’s income is linked to their residential address to allow geographic comparison at the district level (Centraal Bureau voor de Statistiek, 2025.

***Housing-related variables:***

· Average rent prices, specified for two contrasting districts in Amsterdam: Amsterdam-West (relatively affordable) and Amsterdam-Zuid (relatively expensive).

Data originate from the Basisbestand Gebieden Amsterdam (BBGA), which is based on administrative municipal records (e.g., WOZ values, rental data) (Gemeente Amsterdam,2023). Additional housing data were drawn from WiMRA, a survey-based source covering household characteristics, preferences, and mobility in the Amsterdam metropolitan region (*Dataset: Woningmarkt, 2025).*

***Constructed variables:***

Rent burden: Calculated as (average rent / average income) × 100%, this variable expresses the burden of rent in relation to income.

Affordability pressure: Calculated as (rent increase % – income growth %). A positive value indicates that rent is growing faster than income, signaling worsening affordability.

The rent data file covers four specific years at the broader district level, showing how rents shifted over time in areas like West and Zuid. The CBS is a single year, look at who lives in each neighborhood and what they earn. By combining them, we can link the big rent trends to the real income and housing profiles of local residents.

The selected data-sets provide a balanced combination of objective and subjective information, allowing for a nuanced analysis of both economic affordability and perceived housing conditions. Using Amsterdam-West and Amsterdam-Zuid as contrasting districts supports a clear comparison between relatively affordable and expensive housing areas.

While these data sources offer valuable insights, they also come with certain limitations. One key issue is timeliness, as administrative records may be subject to delays in reporting, which can reduce their relevance in a fast-evolving housing market. Moreover, the survey data's representativeness can be affected by non-response bias or insufficient coverage of specific demographic groups, despite the extensive scope of WiMRA. The level of detail is another constraint since the data is presented at an aggregated district or neighborhood level, potentially overlooking important variations at smaller geographic scales, such as individual streets or blocks. Lastly, the derived indicators, such as rent quota and affordability pressure, are based on averages, which may mask the wide range of experiences and disparities among different households.

# Part 3 - Quantifying

## 3.1 Data cleaning

For the CBS data-set, we created the income variables by selecting and combining all wijken in Amsterdam‐West and Zuid, then cleaned and converted the income field to numeric, handled missing values, and calculated average income per neighborhood for 2015, 2017, and 2019. In parallel, we loaded the rent data, removed unnecessary rows, kept only West and Zuid districts, renamed columns for clarity, selected private‐sector rent prices, recoded district names to match the CBS data, and standardized all column names. We then merged the two tables with a left join on wijk and year this preserved every income observation even if a rent record was missing, ensuring no wijk was dropped due to incomplete rent data. In an ideal world, the rent dataset would cover all boroughs instead of just West and Zuid so it would match the income dataset’s full scope.

```{r data_cleaning_huurprijzen, include=FALSE}
# Load rental price data, skipping the first row which likely contains metadata
huur <- read.csv("data/huurprijzen.csv", skip = 1, header = FALSE)

# Keep only rows for West (E West) and Zuid (K Zuid)
huur <- huur[huur$V2 %in% c("E West", "K Zuid"), ]

# Rename columns for clarity
colnames(huur) <- c("Index", "stadsdeel", "2013_p", "2015_p", "2017_p", "2019_p", 
                    "2013_c", "2015_c", "2017_c", "2019_c")

# Select only private sector rent columns and district names
huur_particulier <- huur[, c("stadsdeel", "2013_p", "2015_p", "2017_p", "2019_p")]

# Recode district names to simplified labels
huur_particulier <- huur_particulier %>%
  mutate(stadsdeel = recode(stadsdeel, "E West" = "West", "K Zuid" = "Zuid"))

# Remove '_p' suffix from column names
colnames(huur_particulier) <- sub("_p", "", colnames(huur_particulier)) 

# Convert year columns to numeric
huur_particulier[, -1] <- lapply(huur_particulier[, -1], as.numeric)

huur_long <- read_csv("data/huurprijzen_per_stadsdeel.csv")

huur_long$jaar <- as.numeric(huur_long$jaar)
# Reshape data to long format: one row per district-year with rental price
huur_long <- pivot_longer(huur_particulier, 
                          cols = -stadsdeel, 
                          names_to = "jaar", 
                          values_to = "huurprijs")

```

```{r data_cleaning_income2015, include=FALSE}
# Read the first two rows after skipping 3 to create multi-line headers
headers <- read.csv("data/Kerncijfers_wijken_en_buurten_2015.csv", skip = 3, nrows = 2, sep = ";", header = FALSE)

# Combine the two header rows into single strings per column
new_headers <- paste(headers[1, ], headers[2, ], sep = "")  # Join headers with no space (can be customized)

# Replace whitespace with dots to standardize column names
new_headers <- str_replace_all(new_headers, "\\s+", ".")

# Read the actual data starting from the 6th row (skip metadata rows)
data <- read.csv("data/Kerncijfers_wijken_en_buurten_2015.csv", skip = 5, sep = ";", header = FALSE)

# Apply the newly created header names to the dataset
colnames(data) <- new_headers

# Define the wijks (wijken) within the Zuid district
wijken_zuid <- c('Zuidas','Oude Pijp','Nieuwe Pijp','Zuid Pijp','Hoofddorppleinbuurt',
                 'Schinkelbuurt','Willemspark','Museumkwartier','Stadionbuurt','Apollobuurt',
                 'Buitenveldert-Oost','Buitenveldert-West','Rijnbuurt','Scheldebuurt',
                 'IJselbuurt', 'Prinses Irenebuurt e.o.')

# Define the wijks within the West district
wijken_west <- c('Houthavens', 'Spaarndammer- en Zeeheldenbuurt', 'Staatsliedenbuurt',
                 'Frederik Hendrikbuurt', 'Da Costabuurt', 'Kinkerbuurt', 'Van Lennepbuurt',
                 'Helmersbuurt', 'Overtoomse Sluis', 'Chassébuurt', 'Landlust', 'Erasmuspark',
                 'De Kolenkit', 'Geuzenbuurt', 'Van Galenbuurt', 'Hoofdweg e.o.',
                 'Westindische Buurt','Vondelbuurt','Centrale Markt', 'Sloterdijk')

# Filter data to include only wijks from Zuid
data_zuid_2015 <- data %>%
  filter(Wijken.en.buurten %in% wijken_zuid)

# Select relevant columns and rename them for Zuid
data_zuid_2015 <- data_zuid_2015 %>%
  select(
    wijk = Wijken.en.buurten,
    gem_inkomen = "Inkomen|Inkomen.van.personen|Gemiddeld.inkomen.per.inkomensontvanger.x.1.000.euro"
  )

# Filter data to include only wijks from West
data_west_2015 <- data %>%
  filter(Wijken.en.buurten %in% wijken_west)

# Select relevant columns and rename them for West
data_west_2015 <- data_west_2015 %>%
  select(
    wijk = Wijken.en.buurten,
    gem_inkomen = "Inkomen|Inkomen.van.personen|Gemiddeld.inkomen.per.inkomensontvanger.x.1.000.euro"
  )

# Convert income values from string (with comma) to numeric for Zuid
data_zuid_2015$gem_inkomen <- as.numeric(gsub(",", ".", data_zuid_2015$gem_inkomen))

# Convert income values from string (with comma) to numeric for West
data_west_2015$gem_inkomen <- as.numeric(gsub(",", ".", data_west_2015$gem_inkomen))

# Calculate the average income for Zuid
avg_zuid_2015 <- data_zuid_2015 %>%
  summarise(
    stadsdeel = "Zuid",
    gem_inkomen = round(mean(gem_inkomen, na.rm = TRUE), 2)
  )

# Calculate the average income for West
avg_west_2015 <- data_west_2015 %>%
  summarise(
    stadsdeel = "West",
    gem_inkomen = round(mean(gem_inkomen, na.rm = TRUE), 2)
  )

# Combine the average income data for Zuid and West into one dataset
inkomen_2015 <- bind_rows(avg_zuid_2015, avg_west_2015)

# Add the year as a column to the combined income dataset
inkomen_2015$jaar <- 2015

# Export datasets to CSV files
write_csv(inkomen_2015, "data/inkomen_2015.csv")
write_csv(avg_west_2015, "data/avg_west_2015.csv")
write_csv(avg_zuid_2015, "data/avg_zuid_2015.csv")
write_csv(data_west_2015, "data/data_west_2015.csv")
write_csv(data_zuid_2015, "data/data_zuid_2015.csv")
```

```{r data_cleaning_income_2017, include=FALSE}
# Load the 2017 wijk statistics dataset
data <- read.csv("data/Kerncijfers_wijken_en_buurten_2017.csv")

# Define the wijks (wijken) in the Zuid district
wijken_zuid <- c('Zuidas','Oude Pijp','Nieuwe Pijp','Zuid Pijp','Hoofddorppleinbuurt',
                 'Schinkelbuurt','Willemspark','Museumkwartier','Stadionbuurt','Apollobuurt',
                 'Buitenveldert-Oost','Buitenveldert-West','Rijnbuurt','Scheldebuurt',
                 'IJselbuurt', 'Prinses Irenebuurt e.o.')

# Define the wijks in the West district
wijken_west <- c('Houthavens', 'Spaarndammer- en Zeeheldenbuurt', 'Staatsliedenbuurt',
                 'Frederik Hendrikbuurt', 'Da Costabuurt', 'Kinkerbuurt', 'Van Lennepbuurt',
                 'Helmersbuurt', 'Overtoomse Sluis', 'Chassébuurt', 'Landlust', 'Erasmuspark',
                 'De Kolenkit', 'Geuzenbuurt', 'Van Galenbuurt', 'Hoofdweg e.o.',
                 'Westindische Buurt','Vondelbuurt','Centrale Markt', 'Sloterdijk')

# Filter the full dataset to include only Zuid wijks
data_zuid_2017 <- data %>%
  filter(Wijken.en.buurten %in% wijken_zuid)

# Select relevant columns (wijk name and average income) and rename them for Zuid
data_zuid_2017 <- data_zuid_2017 %>%
  select(
    wijk = Wijken.en.buurten,
    gem_inkomen = Inkomen.Inkomen.van.personen.Gemiddeld.inkomen.per.inkomensontvanger...x.1.000.euro.
  )

# Filter the full dataset to include only West wijks
data_west_2017 <- data %>%
  filter(Wijken.en.buurten %in% wijken_west)

# Select relevant columns (wijk name and average income) and rename them for West
data_west_2017 <- data_west_2017 %>%
  select(
    wijk = Wijken.en.buurten,
    gem_inkomen = Inkomen.Inkomen.van.personen.Gemiddeld.inkomen.per.inkomensontvanger...x.1.000.euro.
  )

# Convert income column to numeric for Zuid (in case it's read as factor or string)
data_zuid_2017$gem_inkomen <- as.numeric(as.character(data_zuid_2017$gem_inkomen))

# Convert income column to numeric for West
data_west_2017$gem_inkomen <- as.numeric(as.character(data_west_2017$gem_inkomen))

# Calculate average income for Zuid and add corresponding district label
avg_zuid_2017 <- data_zuid_2017 %>%
  summarise(
    stadsdeel = "Zuid",
    gem_inkomen = round(mean(gem_inkomen, na.rm = TRUE), 2)
  )

# Calculate average income for West and add corresponding district label
avg_west_2017 <- data_west_2017 %>%
  summarise(
    stadsdeel = "West",
    gem_inkomen = round(mean(gem_inkomen, na.rm = TRUE), 2)
  )

# Combine both district summaries into a single dataset
inkomen_2017 <- bind_rows(avg_zuid_2017, avg_west_2017)

# Add the year column to indicate this data is from 2017
inkomen_2017$jaar <- 2017

# Export data to CSV files for further analysis or reporting
write_csv(avg_west_2017, "data/avg_west_2017.csv")
write_csv(avg_zuid_2017, "data/avg_zuid_2017.csv")
write_csv(data_west_2017, "data/data_west_2017.csv")
write_csv(data_zuid_2017, "data/data_zuid_2017.csv")
write_csv(inkomen_2017, "data/inkomen_2017.csv")
```

```{r data_cleaning_income_2019, include=FALSE}
# Load the 2019 dataset; use dec="," to correctly interpret European-style decimal commas
data <- read.csv("data/Kerncijfers_wijken_en_buurten_2019.csv", dec=",")

# Define the wijks (wijken) in the Zuid district
wijken_zuid <- c('Zuidas','Oude Pijp','Nieuwe Pijp','Zuid Pijp','Hoofddorppleinbuurt',
                 'Schinkelbuurt','Willemspark','Museumkwartier','Stadionbuurt','Apollobuurt',
                 'Buitenveldert-Oost','Buitenveldert-West','Rijnbuurt','Scheldebuurt',
                 'IJselbuurt', 'Prinses Irenebuurt e.o.')

# Define the wijks in the West district
wijken_west <- c('Houthavens', 'Spaarndammer- en Zeeheldenbuurt', 'Staatsliedenbuurt',
                 'Frederik Hendrikbuurt', 'Da Costabuurt', 'Kinkerbuurt', 'Van Lennepbuurt',
                 'Helmersbuurt', 'Overtoomse Sluis', 'Chassébuurt', 'Landlust', 'Erasmuspark',
                 'De Kolenkit', 'Geuzenbuurt', 'Van Galenbuurt', 'Hoofdweg e.o.',
                 'Westindische Buurt','Vondelbuurt','Centrale Markt', 'Sloterdijk')

# Filter data to only include Zuid wijks
data_zuid_2019 <- data %>%
  filter(Wijken.en.buurten %in% wijken_zuid)

# Select relevant columns (wijk name and average income) and rename them
data_zuid_2019 <- data_zuid_2019 %>%
  select(
    wijk = Wijken.en.buurten,
    gem_inkomen = Inkomen.Inkomen.van.personen.Gemiddeld.inkomen.per.inkomensontvanger...x.1.000.euro.
  )

# Filter data to only include West wijks
data_west_2019 <- data %>%
  filter(Wijken.en.buurten %in% wijken_west)

# Select relevant columns (wijk name and average income) and rename them
data_west_2019 <- data_west_2019 %>%
  select(
    wijk = Wijken.en.buurten,
    gem_inkomen = Inkomen.Inkomen.van.personen.Gemiddeld.inkomen.per.inkomensontvanger...x.1.000.euro.
  )

# Calculate average income for Zuid and label with corresponding district name
avg_zuid_2019 <- data_zuid_2019 %>%
  summarise(
    stadsdeel = "Zuid",
    gem_inkomen = round(mean(gem_inkomen, na.rm = TRUE), 2)
  )

# Calculate average income for West and label with corresponding district name
avg_west_2019 <- data_west_2019 %>%
  summarise(
    stadsdeel = "West",
    gem_inkomen = round(mean(gem_inkomen, na.rm = TRUE), 2)
  )

# Combine both district summaries into a single dataset
inkomen_2019 <- bind_rows(avg_zuid_2019, avg_west_2019)

# Add a column indicating the year of the data
inkomen_2019$jaar <- 2019

# Export datasets to CSV files for storage or further use
write_csv(avg_west_2019, "data/avg_west_2019.csv")
write_csv(avg_zuid_2019, "data/avg_zuid_2019.csv")
write_csv(data_west_2019, "data/data_west_2019.csv")
write_csv(data_zuid_2019, "data/data_zuid_2019.csv")
write_csv(inkomen_2019, "data/inkomen_2019.csv")
```

```{r data_cleaning_rent_burden_2015, include=FALSE}
# Combine income data for West and Zuid wijks into one dataset
inkomen_per_wijk_2015 <- bind_rows(data_west_2015, data_zuid_2015)

# Create a copy to compute rent burden
rent_burden_2015 <- inkomen_per_wijk_2015

# Calculate monthly income by converting yearly income (in thousands of euros) to monthly euros
rent_burden_2015 <- rent_burden_2015 %>% 
  mutate(gem_inkomen_per_maand = gem_inkomen * 1000 / 12)

# Define wijks in each district
wijken_zuid <- c('Zuidas','Oude Pijp','Nieuwe Pijp','Zuid Pijp','Hoofddorppleinbuurt',
                 'Schinkelbuurt','Willemspark','Museumkwartier','Stadionbuurt','Apollobuurt',
                 'Buitenveldert-Oost','Buitenveldert-West','Rijnbuurt','Scheldebuurt',
                 'IJselbuurt', 'Prinses Irenebuurt e.o.')
wijken_west <- c('Houthavens', 'Spaarndammer- en Zeeheldenbuurt', 'Staatsliedenbuurt',
                 'Frederik Hendrikbuurt', 'Da Costabuurt', 'Kinkerbuurt', 'Van Lennepbuurt',
                 'Helmersbuurt', 'Overtoomse Sluis', 'Chassébuurt', 'Landlust', 'Erasmuspark',
                 'De Kolenkit', 'Geuzenbuurt', 'Van Galenbuurt', 'Hoofdweg e.o.',
                 'Westindische Buurt','Vondelbuurt','Centrale Markt', 'Sloterdijk')

# Add a 'stadsdeel' (district) column and assign 'Zuid' or 'West' based on wijk
rent_burden_2015$stadsdeel <- 0
rent_burden_2015$stadsdeel <- rent_burden_2015$stadsdeel %>%
  replace(rent_burden_2015$wijk %in% wijken_zuid, "Zuid")
rent_burden_2015$stadsdeel <- rent_burden_2015$stadsdeel %>%
  replace(rent_burden_2015$wijk %in% wijken_west, "West")

# Load rental price data (in long format) and filter for the year 2015
huur_long <- huur_long %>% filter(jaar == 2015)

# Drop the 'jaar' column (since all rows are now 2015)
huur_long$jaar <- NULL

# Join rental price data to income data by district
rent_burden_2015 <- rent_burden_2015 %>% 
  full_join(huur_long, by = "stadsdeel")

# Calculate rent burden as a percentage of monthly income
rent_burden_2015 <- rent_burden_2015 %>% 
  mutate(Rent_burden = huurprijs / gem_inkomen_per_maand * 100)

# Export final rent burden data for 2015 to CSV
write_csv(rent_burden_2015, "data/rent_burden_2015.csv")
```

```{r data_cleaning_rent_burden_2017, include=FALSE}
# Combine income data from West and Zuid wijks for the year 2017
inkomen_per_wijk_2017 <- bind_rows(data_west_2017, data_zuid_2017)

# Copy data to a new object to calculate rent burden
rent_burden_2017 <- inkomen_per_wijk_2017

# Compute monthly income from annual income (convert from thousands of euros to euros per month)
rent_burden_2017 <- rent_burden_2017 %>% 
  mutate(gem_inkomen_per_maand = gem_inkomen * 1000 / 12)

# Define wijk names for Zuid and West districts
wijken_zuid <- c('Zuidas','Oude Pijp','Nieuwe Pijp','Zuid Pijp','Hoofddorppleinbuurt',
                 'Schinkelbuurt','Willemspark','Museumkwartier','Stadionbuurt','Apollobuurt',
                 'Buitenveldert-Oost','Buitenveldert-West','Rijnbuurt','Scheldebuurt',
                 'IJselbuurt', 'Prinses Irenebuurt e.o.')
wijken_west <- c('Houthavens', 'Spaarndammer- en Zeeheldenbuurt', 'Staatsliedenbuurt',
                 'Frederik Hendrikbuurt', 'Da Costabuurt', 'Kinkerbuurt', 'Van Lennepbuurt',
                 'Helmersbuurt', 'Overtoomse Sluis', 'Chassébuurt', 'Landlust', 'Erasmuspark',
                 'De Kolenkit', 'Geuzenbuurt', 'Van Galenbuurt', 'Hoofdweg e.o.',
                 'Westindische Buurt','Vondelbuurt','Centrale Markt', 'Sloterdijk')

# Initialize 'stadsdeel' column and assign district names based on wijk
rent_burden_2017$stadsdeel <- 0
rent_burden_2017$stadsdeel <- rent_burden_2017$stadsdeel %>%
  replace(rent_burden_2017$wijk %in% wijken_zuid, "Zuid")
rent_burden_2017$stadsdeel <- rent_burden_2017$stadsdeel %>%
  replace(rent_burden_2017$wijk %in% wijken_west, "West")

# Load rent price data and filter for the year 2017
huur_long <- read_csv("data/huurprijzen_per_stadsdeel.csv")
huur_long <- huur_long %>% filter(jaar == 2017)

# Remove the 'jaar' column since it's no longer needed after filtering
huur_long$jaar <- NULL

# Preview stadsdeel column (likely for debugging or inspection)
huur_long$stadsdeel

# Join rent prices to income data by district
rent_burden_2017 <- rent_burden_2017 %>% 
  full_join(huur_long, by = "stadsdeel")

# Calculate rent burden as percentage of monthly income
rent_burden_2017 <- rent_burden_2017 %>% 
  mutate(Rent_burden = huurprijs / gem_inkomen_per_maand * 100)

# Save the resulting rent burden data for 2017 to a CSV file
write_csv(rent_burden_2017, "data/rent_burden_2017.csv")
```

```{r data_cleaning_rent_burden_2019, include=FALSE}
# Combine income data from West and Zuid wijks for 2019
inkomen_per_wijk_2019 <- bind_rows(data_west_2019, data_zuid_2019)

# Duplicate the data for calculating rent burden
rent_burden_2019 <- inkomen_per_wijk_2019

# Calculate average monthly income from annual income (in euros, originally in thousands)
rent_burden_2019 <- rent_burden_2019 %>%
  mutate(gem_inkomen_per_maand = gem_inkomen * 1000 / 12)

# Define wijks belonging to Zuid
wijken_zuid <- c('Zuidas','Oude Pijp','Nieuwe Pijp','Zuid Pijp','Hoofddorppleinbuurt',
                 'Schinkelbuurt','Willemspark','Museumkwartier','Stadionbuurt','Apollobuurt',
                 'Buitenveldert-Oost','Buitenveldert-West','Rijnbuurt','Scheldebuurt',
                 'IJselbuurt', 'Prinses Irenebuurt e.o.')

# Define wijks belonging to West
wijken_west <- c('Houthavens', 'Spaarndammer- en Zeeheldenbuurt', 'Staatsliedenbuurt',
                 'Frederik Hendrikbuurt', 'Da Costabuurt', 'Kinkerbuurt', 'Van Lennepbuurt',
                 'Helmersbuurt', 'Overtoomse Sluis', 'Chassébuurt', 'Landlust', 'Erasmuspark',
                 'De Kolenkit', 'Geuzenbuurt', 'Van Galenbuurt', 'Hoofdweg e.o.',
                 'Westindische Buurt','Vondelbuurt','Centrale Markt', 'Sloterdijk')

# Initialize the 'stadsdeel' (district) column
rent_burden_2019$stadsdeel <- 0

# Assign 'Zuid' to wijks in Zuid
rent_burden_2019$stadsdeel <- rent_burden_2019$stadsdeel %>%
  replace(rent_burden_2019$wijk %in% wijken_zuid, "Zuid")

# Assign 'West' to wijks in West
rent_burden_2019$stadsdeel <- rent_burden_2019$stadsdeel %>%
  replace(rent_burden_2019$wijk %in% wijken_west, "West")

# Read rent prices per district and filter for 2019
huur_long <- read_csv("data/huurprijzen_per_stadsdeel.csv")
huur_long <- huur_long %>% filter(jaar == 2019)

# Remove the 'jaar' column as it's no longer needed after filtering
huur_long$jaar <- NULL

# Display the 'stadsdeel' column (likely for debugging or checking values)
huur_long$stadsdeel

# Merge rent price data with income data based on district
rent_burden_2019 <- rent_burden_2019 %>% 
  full_join(huur_long, by = "stadsdeel")

# Calculate rent burden as percentage of income
rent_burden_2019 <- rent_burden_2019 %>%
  mutate(Rent_burden = huurprijs / gem_inkomen_per_maand * 100)

# Export the resulting dataset to a CSV file
write_csv(rent_burden_2019, "data/rent_burden_2019.csv")
```

```{r merging_income_and_hurprijs, include=FALSE}
# Reshape data to long format: one row per district-year with rental price
huur_long <- pivot_longer(huur_particulier, 
                          cols = -stadsdeel, 
                          names_to = "jaar", 
                          values_to = "huurprijs")
# Load income data for 2015
inkomen_2015 <- read_csv("data/inkomen_2015.csv")

# Combine income data across multiple years into a single dataframe
inkomen <- bind_rows(inkomen_2015, inkomen_2017, inkomen_2019)

# Convert 'jaar' columns in both dataframes to character
inkomen$jaar <- as.character(inkomen$jaar)
huur_long$jaar <- as.character(huur_long$jaar)

# Merge inkomen with huur_long by 'stadsdeel' and 'jaar'
merged_df <- inkomen %>%
  left_join(huur_long, by = c("stadsdeel", "jaar"))

```

```{r merging_rent_burden, include=FALSE}
# Merge rent burden data for 2015, 2017, and 2019 into a single dataframe
merged_rent_burden <- bind_rows(rent_burden_2015, rent_burden_2017, rent_burden_2019)

# Add a 'jaar' (year) column to each individual year's dataset
rent_burden_2015 <- rent_burden_2015 %>% mutate(jaar = 2015)
rent_burden_2017 <- rent_burden_2017 %>% mutate(jaar = 2017)
rent_burden_2019 <- rent_burden_2019 %>% mutate(jaar = 2019)

# Recombine the updated datasets with year included and sort by year
merged_rent_burden <- bind_rows(rent_burden_2015, rent_burden_2017, rent_burden_2019) %>%
  arrange(jaar)
```

## 3.2 Generate necessary variables

Variable 1: Rent burden: Calculated as (average rent / average income) × 100%, this variable expresses the burden of rent in relation to income.

Rent burden For the temporal analysis we used rent burden per borough. Therefore we used the averages we calculated.

```{r gen_var1_rent_burden_per_borough, include=FALSE}
# Convert average annual income (in thousands of euros) to monthly income in euros
merged_df$gem_inkomen <- (merged_df$gem_inkomen * 1000) / 12

# Calculate rent burden as a percentage of monthly income
merged_df$rent_burden <- (merged_df$huurprijs / merged_df$gem_inkomen) * 100
```

For the spatial analysis we uses rent burden per wijk. Therefore we calculated that one per wijk that belonged to each district.

```{r gen_var1_rent_burden_per_wijk, include=FALSE}
# Rent burden per wijk in 2019 for example (can also find in previous code)
# Calculate average monthly income from annual income (in euros, originally in thousands)
rent_burden_2019 <- rent_burden_2019 %>%
  mutate(gem_inkomen_per_maand = gem_inkomen * 1000 / 12)
```

Variable 2: Affordability pressure

```{r gen_var2_affordability_pressure, include=FALSE}
# Arrange the data by district (stadsdeel) and year for proper chronological order
data_with_growth <- merged_df %>%
  arrange(stadsdeel, jaar) %>%
  group_by(stadsdeel) %>%
  mutate(
    # Calculate income growth (%) compared to the previous year within each district
    groei_inkomen = (gem_inkomen - lag(gem_inkomen)) / lag(gem_inkomen) * 100,
    
    # Calculate rent price growth (%) compared to the previous year within each district
    groei_huurprijs = (huurprijs - lag(huurprijs)) / lag(huurprijs) * 100
  )

# Compute affordability pressure as the difference between rent growth and income growth
data_with_growth$affordability_pressure <- (data_with_growth$groei_huurprijs - data_with_growth$groei_inkomen)
```

Affordability pressure: Calculated as (rent increase % – income growth %). A positive value indicates that rent is growing faster than income, signaling worsening affordability.

For the affordability pressure we combined the percentage change of rent increase and the percentage change of income, to not only look at how the rent rose but if it out paces the income gains. We intend to use this for visualization charts event analysis.

## 3.3 Visualize temporal variation

How has rent burden evolved from 2017 to 2019 in West vs. Zuid?

```{r Multiline_plot_of_Rent_Burden_over_time_for_West_and_Zuid, echo=FALSE}
# Create a line plot showing the rent burden across years for each stadsdeel (district)
ggplot(data_with_growth, aes(x = jaar, y = rent_burden, color = stadsdeel)) +
  
  # Add lines to connect rent burden values over time for each district
  geom_line(linewidth = 1.2) +
  
  # Add points at each data value for better visibility
  geom_point(size = 2) +
  
  # Set specific breaks on the x-axis (only the measured years)
  scale_x_discrete(breaks = c(2015, 2017, 2019)) +
  
  # Add plot labels and title
  labs(
    title = "Rent Burden in West and Zuid (2015–2019)",  
    x = "Year",                                           
    y = "Rent Burden (%)",                                
    color = "Stadsdeel"                                   
  ) +
  
  # Apply a minimal theme for a clean appearance
  theme_minimal()
```

We’ll plot survey year on the x-axis and rent quota on the y-axis, drawing two colored lines one for West and one for Zuid so you can see how rent burden evolved over time between 2017 and 2019. By placing time on the horizontal axis and clearly labeling each district, the chart directly aligns with our question about temporal variation in affordability stress, revealing exactly when and by how much Zuid’s rent burden outpaced West’s.

## 3.4 Visualize spatial variation

How does rent burden vary across neighborhoods in Amsterdam West vs. Zuid?

```{r Choropleth_Maps_Rent_Burden_by_wijk_2017, echo=FALSE}
amsterdam_map <- st_read("data/adam.geojson")
amsterdam_map <- amsterdam_map %>%
  rename(wijk = wijknaam)
amsterdam_map <- amsterdam_map %>%
  filter(gemeentenaam == "Amsterdam")

combined_df <- bind_rows(data_zuid_2017, data_west_2017)
map_data <- amsterdam_map %>%
  left_join(combined_df, by = "wijk")

# Compute mean rent burden per wijk (wijk) for 2017
mean_rent_map_2017 <- rent_burden_2017 %>%
  filter(!is.na(Rent_burden)) %>%
  group_by(wijk) %>%
  summarise(mean_rent_burden = mean(Rent_burden, na.rm = TRUE))

# Join mean rent burden to spatial map data for 2017
map_data_2017 <- amsterdam_map %>%
  left_join(mean_rent_map_2017, by = "wijk")

# --- Prepare 2019 Data ---

# Compute mean rent burden per wijk (wijk) for 2019
mean_rent_map_2019 <- rent_burden_2019 %>%
  filter(!is.na(Rent_burden)) %>%
  group_by(wijk) %>%
  summarise(mean_rent_burden = mean(Rent_burden, na.rm = TRUE))

# Join mean rent burden to spatial map data for 2019
map_data_2019 <- amsterdam_map %>%
  left_join(mean_rent_map_2019, by = "wijk")

# --- Define Shared Color Scale Across Both Years ---

# Determine combined min/max range to ensure consistent fill scale
combined_range <- range(
  c(mean_rent_map_2017$mean_rent_burden, mean_rent_map_2019$mean_rent_burden),
  na.rm = TRUE
)

# Generate breaks every 5% for legend ticks
breaks_seq <- seq(
  floor(combined_range[1] / 5) * 5,
  ceiling(combined_range[2] / 5) * 5,
  by = 5
)

# --- Plot: Average Rent Burden by wijk in 2017 ---

ggplot(map_data_2017) +
  geom_sf(aes(fill = mean_rent_burden), color = "white", size = 0.3) +  # draw wijks
  scale_fill_viridis_c(   # apply perceptually uniform color scale
    option = "magma",
    na.value = "grey90",   # color for NA values
    direction = -1,        # reverse scale direction
    limits = combined_range,  # consistent scale across years
    breaks = breaks_seq
  ) +
  labs(
    title = "Average Rent Burden by wijk in Amsterdam (2017)",
    fill = "Mean Rent Burden (%)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    legend.position = "right"
  )
```

```{r Choropleth_Maps_Rent_Burden_by_wijk_2019, echo=FALSE}
# --- Plot: Average Rent Burden by wijk in 2019 ---

ggplot(map_data_2019) +
  geom_sf(aes(fill = mean_rent_burden), color = "white", size = 0.3) +  # draw wijks
  scale_fill_viridis_c(
    option = "magma",
    na.value = "grey90",
    direction = -1,
    limits = combined_range,
    breaks = breaks_seq
  ) +
  labs(
    title = "Average Rent Burden by wijk in Amsterdam (2019)",
    fill = "Mean Rent Burden (%)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    legend.position = "right"
  )
```

We’ll use the official Amsterdam wijk shapefile to draw West and Zuid at just the right scale zoomed in enough to show every wijk but not so far out that details get lost and shade each area by its rent-to-income ratio. A brief caption will explain that darker colors mark the highest rent burden, directly tying the map back to our question about where affordability stress is worst. By relying on accurate spatial data, appropriate zoom, and clear labels, the map will make it easy to spot the neighborhoods that need the most support.

## 3.5 Visualize sub-population variation

Which neighborhoods carry the heaviest rent burden, and how does this differ in West vs. Zuid?

```{r Boxplot_of_Rent_Burden_per_wijk_or_2017_and_2019, echo=FALSE}
# Add year column to each dataset
rent_burden_2017 <- rent_burden_2017 %>% mutate(jaar = 2017)
rent_burden_2019 <- rent_burden_2019 %>% mutate(jaar = 2019)

# Combine data from both years and remove incomplete entries
rent_burden_clean <- bind_rows(rent_burden_2017, rent_burden_2019) %>%
  filter(!is.na(Rent_burden), !is.na(stadsdeel), !is.na(wijk))

# Create the boxplot
ggplot(rent_burden_clean, aes(x = reorder(wijk, Rent_burden), y = Rent_burden, fill = stadsdeel)) +
  
  # Draw boxplots without outliers and semi-transparent fill
  geom_boxplot(outlier.shape = NA, alpha = 0.8, width = 0.6) +
  
  # Add jittered points to show individual data by year
  geom_jitter(aes(color = factor(jaar)), width = 0.2, size = 2, alpha = 0.7) +
  
  # Manually set colors for districts (stadsdelen)
  scale_fill_manual(values = c("Zuid" = "#1f78b4", "West" = "#33a02c")) +
  
  # Manually set colors for years
  scale_color_manual(values = c("2017" = "#e41a1c", "2019" = "#377eb8")) +
  
  # Labels and title
  labs(
    title = "Rent Burden Distribution Across wijks in West and Zuid (2017 & 2019)",
    x = "wijk (wijk)",
    y = "Rent Burden (% of income spent on rent)",
    fill = "Stadsdeel",
    color = "Year"
  ) +
  
  # Apply a clean minimal theme
  theme_minimal(base_size = 14) +
  
  # Improve x-axis text readability and title style
  theme(
    axis.text.x = element_text(size = 12, angle = 45, hjust = 1),
    plot.title = element_text(face = "bold"),
    legend.position = "top"
  ) +
  
  # Add space above boxplots to avoid clipping
  scale_y_continuous(expand = expansion(mult = c(0.05, 0.15)))
```

We’ll draw side-by-side box-plots of each neighborhood’s rent‐to‐income ratio, grouping boxes by wijk and coloring them by borough (West vs Zuid), then facet the entire plot into two panels one for West, one for Zuid. This setup treats each borough as a sub-population, so you can directly compare how rent burden distributions (medians, IQRs, and upper tails) differ across neighborhoods and between boroughs. A concise caption will explain that taller boxes and longer upper whiskers signal where affordability stress is most severe, tying the visualization back to our question about which neighborhoods and which sub-populations carry the heaviest rent burden.

## 3.6 Event analysis

What happened to rent burden growth when Airbnb caps came in (2018 and 2019)?

```{r Line_Plot_of_Affordability_Pressure_Index_with_Airbnb_Cap_Annotation, echo=FALSE}
# Create base values for 2015: index set to 100 for both stadsdelen
base_2015 <- data.frame(
  stadsdeel = c("West", "Zuid"),
  jaar = 2015,
  affordability_index = 100
)

# Prepare affordability index for 2017 and 2019
growth_data <- data_with_growth %>%
  filter(jaar %in% c(2017, 2019)) %>%         # Only take years after 2015
  group_by(stadsdeel) %>%
  mutate(
    # Affordability index is calculated by adding affordability pressure to the 2015 baseline (100)
    affordability_index = 100 + affordability_pressure
  ) %>%
  select(stadsdeel, jaar, affordability_index)

# Combine baseline with growth data and sort
growth_data$jaar <- as.numeric(growth_data$jaar)
plot_data <- bind_rows(base_2015, growth_data) %>%
  arrange(stadsdeel, jaar)

# Create the line plot
ggplot(plot_data, aes(x = jaar, y = affordability_index, color = stadsdeel)) +
  
  # Draw trend lines for each stadsdeel
  geom_line(linewidth = 1.3) +
  
  # Add data points
  geom_point(size = 3) +
  
  # Add a dashed vertical line for the policy intervention (Airbnb cap)
  geom_vline(xintercept = 2018, linetype = "dashed", color = "black") +
  
  # Annotate the Airbnb Cap line
  annotate("text", 
           x = 2018, 
           y = max(plot_data$affordability_index, na.rm = TRUE) * 0.98,  # slightly below the top
           label = "Airbnb Cap", 
           angle = 90, 
           vjust = -0.5, 
           hjust = 1, 
           size = 4, 
           color = "black") +
  
  # Define x-axis break
  scale_x_continuous(breaks = c(2015, 2017, 2019)) +
  
  # Labels and title
  labs(
    title = "Affordability Pressure Index (2015 = 100)",
    x = "Year",
    y = "Affordability Index",
    color = "Stadsdeel"
  ) +
  
  # Clean, minimal theme with bold title
  theme_minimal(base_size = 14) +
  theme(
    plot.title = element_text(face = "bold"),
    legend.position = "top"
  )
```

We’ll plot a timeline of the year-over-year percent change in rent burden (y-axis) across survey years and mark the two key events mid-2018 and January 2019 Airbnb cap implementations with vertical lines and labels. By placing those events directly on the same chart as the percent-change values, we can see if the slope of the line flattens or dips immediately afterward. If the growth rate in rent burden noticeably slows following the caps, it suggests those regulations had a tangible impact on easing affordability pressure demonstrating how policy can shift housing-cost dynamics over time.

# Part 4 - Discussion

## 4.1 Discuss your findings

Between 2017 and 2019, rising rent prices in Amsterdam revealed growing inequalities between districts, particularly Amsterdam-West and Amsterdam-Zuid. By combining rent statistics with income data, we were able to accurately assess the housing cost burden, defined as the percentage of household income spent on rent, across different incomes in different areas. This approach allowed us to evaluate how rent increases affected various segments of the population.

Our analysis shows that the rent burden increased in both districts during this period. However, the rise was more pronounced in Amsterdam-Zuid, where rent levels were already significantly higher than in other areas. As a result, even households in higher-income brackets began to experience relatively greater financial pressure. This contrasts with Amsterdam-West, where although the rent burden also grew, it did so at a more moderate pace, suggesting a relatively less severe impact.

The spatial distribution of rent burden revealed further disparities. In Amsterdam-West, the burden is more evenly spread across neighborhoods, with many areas maintaining levels close to or below 30%, a threshold generally considered manageable. In Zuid, however, certain neighborhoods exhibited extremely high rent burdens, in some cases approaching or exceeding 40%. These findings point to serious affordability issues, even in districts traditionally viewed as wealthy.

Further insights come from our sub-population analysis using wijk-level boxplots. This analysis revealed that the variation in rent burden is greater in Zuid than in West, indicating deeper internal inequalities. In Zuid, some neighborhoods experience low rent burdens, likely due to very high local incomes, while others face steep housing costs. In contrast, the range of rent burden values in West is narrower, pointing to a more balanced and stable situation for its residents.

Our event analysis focused on the introduction of Airbnb regulations in 2018 and 2019. These policies, which limited the number of rental nights, were associated with a slight slowdown in the rising rent burden. However, this deceleration was not substantial enough to counteract the sharp increases that had already occurred. This suggests that while the regulations were a step in the right direction, they came too late to reverse the broader trend of declining affordability.

Finally, the affordability pressure indicator further illustrates the depth of the crisis. In many neighborhoods, rent rose at a faster pace than income. This was especially evident in West, where income growth remained limited. In Zuid, income levels increased slightly more, but still failed to keep up with the high absolute rent costs. As a result, average- and low-income households across both districts are increasingly at risk of displacement, forced relocation and even homelessness, underscoring the urgent need for targeted housing policy interventions.

# Part 5 - Reproducibility

## 5.1 Github repository link

Provide the link to your PUBLIC repository here: <https://github.com/elakyc15/Group-7>

## 5.2 Reference list

Custers, G. (2022). De wooncrisis in Nederland: voorbij het idee van ‘natuurverschijnsel’. *Tijdschrift Sociologie*, *3*(0). <https://doi.org/10.38139/ts.2022.27>

Eichholtz, M. K. M. F. P. (2022, 10 december). *Dure huizen maar geen zeepbel in Amsterdam*. ESB. <https://esb.nu/dure-huizen-maar-geen-zeepbel-in-amsterdam/>

Centraal Bureau voor de Statistiek. (2025). *Kerncijfers wijken en buurten 2022* [Data set]. Retrieved June 4, 2025, from <https://opendata.cbs.nl/statline/#/CBS/nl/dataset/85318NED/table?ts=1749040045409> ([opendata.cbs.nl](https://opendata.cbs.nl/?utm_source=chatgpt.com))

<https://opendata.cbs.nl/statline/#/CBS/nl/dataset/84583NED/table?ts=1749115541907>

*Dataset: Woningmarkt \| Website onderzoek en statistiek*. (z.d.).

[[https://onderzoek.amsterdam.nl/dataset/woningmarkt-amsterdam]{.underline}](https://onderzoek.amsterdam.nl/dataset/woningmarkt-amsterdam)

*Wonen in de Metropoolregio Amsterdam (WiMRA) 2021 - metropoolregioamsterdam*. (2022, 24 maart). Metropoolregioamsterdam. <https://www.metropoolregioamsterdam.nl/wimra-2021/>

*Dataset: Basisbestand Gebieden Amsterdam (BBGA) \| Website Onderzoek en Statistiek*. (n.d.). <https://onderzoek.amsterdam.nl/dataset/basisbestand-gebieden-amsterdam-bbga>
